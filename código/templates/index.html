{% extends "layout.html" %}

{% block body %}
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw==" crossorigin="anonymous"></script>
        <label for="playlists">Escolha uma playlist:</label>

        <select name="playlists" id="playlists">
            {% for playlist in playlists %}
            <option value="{{playlist.name}}">{{playlist.name}}</option>
            {% endfor %}
        </select>

        <canvas id="traceplot" width="400" height="400"></canvas>
        <canvas id="histograma" width="400" height="400"></canvas>

        <script>
            $('select').on('change', function() {
                $.get("/get_posterior", {"playlist": this.val})
                    .done(function(dados) {
                        alert(dados["danceability"]["alpha0"].keys());

                        var ctx = document.getElementById('traceplot').getContext('2d');
                        var myChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: [...Array(dados["danceability"]["alpha0"].length).keys()],
                                datasets: {
                                        label: "Alpha 0",
						                backgroundColor: 'rgba(255, 99, 132, 1)',
						                borderColor: 'rgba(255, 99, 132, 1)',
                                        data: dados["danceability"]["alpha0"].map(Number),
						                fill: false,
						                pointRadius: 10,
						                pointHoverRadius: 15,
						                showLine: false
                                    }
                            },
                            options: {
                                scales: {
                                    yAxes: [{
                                        ticks: {
                                            beginAtZero: false
                                        }
                                    }]
                                }
                            }
                        });
                    });
                });
        </script>
        
{% endblock %}